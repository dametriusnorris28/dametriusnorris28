<#
.SYNOPSIS
    This PowerShell script ensures that the removal of the EnableCertPaddingCheck registry setting from both 32-bit and 64-bit locations

.NOTES
    Author          : Dametrius Norris
    LinkedIn        : linkedin.com/in/dametrius-norris/
    GitHub          : github.com/dametriusnorris28
    Date Created    : 2025-03-02
    Last Modified   : 2025-03-02
    Version         : 1.0
    CVEs            : CVE-2013-3900
    Plugin IDs      : 166555
    STIG-ID         : N/A

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    Put any usage instructions here.
    Example syntax:
    PS C:\> .\CVE-2013-3900.ps1 
#>

# Define the registry paths for 64-bit and 32-bit registry locations
$RegistryPaths = @(
    "HKLM:\Software\Microsoft\Cryptography\Wintrust\Config",
    "HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config"
)

# Define the registry value name and expected data type
$ValueName = "EnableCertPaddingCheck"
$ValueData = 1  # DWord (correct type for mitigation)

# Function to enable the fix
function Enable-Fix {
    Write-Host "Enabling stricter Authenticode verification for CVE-2013-3900..."
    foreach ($RegistryPath in $RegistryPaths) {
        if (-not (Test-Path $RegistryPath)) {
            New-Item -Path $RegistryPath -Force | Out-Null
        }
        Set-ItemProperty -Path $RegistryPath -Name $ValueName -Value $ValueData -Type DWord
    }
    Write-Host "Fix enabled. A system restart is recommended for full effect."
}

# Function to disable the fix
function Disable-Fix {
    Write-Host "Disabling stricter Authenticode verification..."
    foreach ($RegistryPath in $RegistryPaths) {
        Remove-ItemProperty -Path $RegistryPath -Name $ValueName -ErrorAction SilentlyContinue
    }
    Write-Host "Fix disabled. A system restart is recommended for full effect."
}
